<template>
   <form name="casesForm" id="casesForm" method="post" action="/api/cases/" submit.delegate="submitCase()">
       <div class="row">
           <div class="col-sm-12">
               <div class="panel panel-default">
                   <div class="panel-heading">Case</div>
                   <div class="panel-body">
                       <div repeat.for="item of caseFieldData">
                           <require from="ObjectKeysValueConverter"></require>
                           <div>
                               <div repeat.for="prop of item | objectKeys">
                                   <div if.bind="prop.type == 'input'">
                                       <div class="col-sm-4">
                                           <div>
                                               <label for="${prop.name}">${prop.namePretty} </label>
                                           </div>
                                           <div>
                                                <span>
                                                    <input type="text" name="caseFieldData[case][${prop.name}]" id="${prop.name}" value.bind="caseFieldData[0][prop.name]['value']" placeholder="${prop.placeholder}">
                                                </span>
                                           </div>
                                       </div>
                                   </div>

                                   <div if.bind="prop.type == 'textarea'">
                                       <div class="col-sm-6">
                                           <div>
                                               <label for="${prop.name}">${prop.namePretty} </label>
                                           </div>
                                           <span>
                                                <textarea rows="10" name="caseFieldData[case][${prop.name}]" id="${prop.name}"  value.bind="caseFieldData[0][prop.name]['value']"></textarea>
                                           </span>
                                       </div>
                                   </div>
                               </div>
                           </div>
                       </div>
                   </div>
               </div>
           </div>
       </div>

       <div class="row">
           <div class="col-sm-12">
               <div class="panel panel-default">
                   <div class="panel-heading">Charge</div>
                   <div class="panel-body">
                       <div class="col-sm-3">
                           <div class="charge-select-wrapper">
                               <div class="charge-select2-container">
                                   <require from="resources/custom-select"></require>

                                   <div>
                                       <label for="${charge.id}">Charge(s): </label>
                                   </div>

                                   <select class="charge-select" select2.bind="options" value.bind="selectedCharge" multiple="multiple" name="data[charge]">
                                       <option repeat.for="charge of charges" model.bind="charge.id" id="${charge.id}" value="${charge.id}">${charge.charges}</option>
                                   </select>
                               </div>
                           </div>
                       </div>
                   </div>
               </div>
           </div>
       </div>

       <div id="victimSection">
           <section id="victim">
               <div if.bind="victimFieldData.length !== 0" repeat.for="item of victimFieldData">
                   <div class="panel panel-default">
                       <div class="panel-heading">Victim ${$index + 1}</div>
                       <div class="panel-body">
                           <div class="index" style="visibility: hidden;">${$parentIndex = $index}</div>
                           <div class="row">
                               <div class="col-sm-4" repeat.for="prop of item | objectKeys">
                                   <div>
                                       <label for="victim-${prop.name}-${$parentIndex}">${prop.namePretty}: </label>
                                   </div>
                                   <div>
                                        <span>
                                            <input if.bind="prop.type  == 'input'" type="text" name="victimFieldData[${$parentIndex}][${prop.name}]" id="victim-${prop.name}-${$parentIndex}" value.bind="victimFieldData[$parentIndex][prop.name]['value']" placeholder="${prop.placeholder}">

                                            <div if.bind="prop.type  == 'select'">
                                                <select name="victimFieldData[${$parentIndex}][${prop.name}]" id="victim-${prop.name}-${$parentIndex}" value.bind="victimFieldData[$parentIndex][prop.name]['value']">
                                                    <option repeat.for="option of prop.options | objectKeys">${option.name}</option>
                                                </select>
                                            </div>
                                        </span>
                                   </div>
                               </div>
                           </div>
                       </div>
                   </div>
               </div>
           </section>

           <button id="addVictim" class="btn btn-green" click.delegate="addVictim()">Add Victim</button>
       </div>

       <div id="offenderSection">
           <section id="offender">
               <div if.bind="data.offenders.length !== 0" repeat.for="item of offenderFieldData">
                   <div class="panel panel-default">
                       <div class="panel-heading">Offender ${$index + 1}</div>
                       <div class="panel-body">
                           <div class="index" style="display: none;">${$parentIndex = $index}</div>
                           <div class="row">
                               <div class="col-sm-4" repeat.for="prop of item | objectKeys">
                                   <div>
                                       <label for="offender-${prop.name}-${$parentIndex}">${prop.namePretty}: </label>
                                   </div>
                                   <div>
                                        <span>
                                            <input if.bind="prop.type  == 'input'" type="text" name="offenderFieldData[${$parentIndex}][${prop.name}]" id="offender-${prop.name}-${$parentIndex}" value.bind="offenderFieldData[$parentIndex][prop.name]['value']" placeholder="${prop.placeholder}">

                                            <div if.bind="prop.type  == 'select'">
                                                <select name="offenderFieldData[${$parentIndex}][${prop.name}]" id="offender-${prop.name}-${$parentIndex}" value.bind="offenderFieldData[$parentIndex][prop.name]['value']">
                                                    <option repeat.for="option of prop.options | objectKeys">${option.name}</option>
                                                </select>
                                            </div>
                                        </span>
                                   </div>
                               </div>
                           </div>
                       </div>
                   </div>
               </div>
           </section>
           <button id="addOffender" class="btn btn-orange" click.delegate="addOffender()">Add Offender</button>
       </div>

       <button type="submit">Submit</button>
   </form>
</template>