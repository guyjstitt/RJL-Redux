<template>
   <form name="casesForm" id="casesForm" method="post" action="/api/cases/" submit.delegate="submitCase()">
       <div class="row" repeat.for="item of caseFieldData">
           <require from="ObjectKeysValueConverter"></require>
           <div class="col-sm-3" repeat.for="prop of item | objectKeys">
               <label for="${prop.name}">${prop.namePretty} </label>
               <input type="text" name="data[case][${prop.name}]" id="${prop.name}" value.bind="prop.value">
           </div>
       </div>


       <div class="row">
           <div class="col-sm-3">
               <div class="charge-select2-container">
                   <require from="resources/custom-select"></require>

                   <select select2.bind="options" value.bind="selectedCharge" multiple="multiple" name="data[charge][]">
                       <option repeat.for="charge of charges" model.bind="charge.id" id="${charge.id}" value="${charge.id}">${charge.charges}</option>
                   </select>
               </div>
           </div>
       </div>

       <div id="victimSection">
           <section id="victim">
               <div repeat.for="item of victimFieldData">
                   <div class="panel panel-default">
                       <div class="panel-heading">Victim ${$index + 1}</div>
                       <div class="panel-body">
                           <div class="index" style="display: none;">${$parentIndex = $index}</div>
                           <require from="ObjectKeysValueConverter"></require>
                           <div class="row">
                               <div class="col-sm-3" repeat.for="prop of item | objectKeys">
                                   <label for="victim-${prop.name}-${$parentIndex}">${prop.namePretty}: </label>
                                   <input if.bind="prop.type  == 'input'" type="text" name="data[victim][${$parentIndex}][${prop.name}]" id="victim-${prop.name}-${$parentIndex}" value.bind="prop.value">
                               </div>
                           </div>
                       </div>
                   </div>
               </div>
           </section>
           <button id="addVictim" class="btn btn-green" click.delegate="addVictim()">Add Victim</button>
       </div>

       <div id="offenderSection">
           <section id="offender">
               <div repeat.for="item of offenderFieldData">
                   <div class="panel panel-default">
                       <div class="panel-heading">Offender ${$index + 1}</div>
                       <div class="panel-body">
                           <div class="index" style="display: none;">${$parentIndex = $index}</div>
                           <require from="ObjectKeysValueConverter"></require>
                           <div class="row">
                               <div class="col-sm-3" repeat.for="prop of item | objectKeys">
                                   <label for="offender-${prop.name}-${$parentIndex}">${prop.namePretty}: </label>
                                   <input if.bind="prop.type  == 'input'" type="text" name="data[offender][${$parentIndex}][${prop.name}]" id="offender-${prop.name}-${$parentIndex}" value.bind="prop.value">
                               </div>
                           </div>
                       </div>
                   </div>
               </div>
           </section>
           <button id="addOffender" class="btn btn-orange" click.delegate="addOffender()">Add Offender</button>
       </div>

       <button type="submit">Submit</button>
   </form>
</template>